
#特色
工厂模式修改属性


## 员工启用/禁用功能实现逻辑总结
### 1. 前端请求处理
- 请求路径：`POST /admin/employee/status/{status}?id={id}`
- 使用 PathVariable 传递状态值（1 为启用，0 为禁用）和员工 id 参数
### 2. Controller 层处理
```java
@PostMapping("/status/{status}")
@ApiOperation("启用禁用员工")
public Result startOrStop(@PathVariable Integer status,Long id){
    log.info("启用禁用员工账号：{}，{}",status,id);
    employeeService.startOrStop(status,id);
    return Result.success();
}
```
### 3. Service 层实现
```java
@Override
public void startOrStop(Integer status, Long id) {
    Employee employee = Employee.builder()
            .status(status)
            .id(id)
            .build();
    
    employeeMapper.update(employee);
}
```
使用 MyBatis 的 XML 配置实现动态 SQL 更新：
```xml
<update id="update" parameterType="Employee">
    update employee
    <set>
        <if test="name !=null">name=#{name},</if>
        <if test="username !=null">username= #{username},</if>
        <if test="password !=null">password= #{password},</if>
        <if test="phone !=null">phone= #{phone},</if>
        <if test="sex !=null">sex= #{sex},</if>
        <if test="idNumber !=null">id_number= #{idNumber},</if>
        <if test="updateTime !=null">update_time= #{updateTime},</if>
        <if test="updateUser !=null">update_user= #{updateUser},</if>
        <if test="status !=null">status= #{status},</if>
    </set>
    where id=#{id}
</update>
```
### 5. 登录时状态检查
在员工登录时会检查账号状态，如果账号被禁用则抛出异常：
```java
if (employee.getStatus() == StatusConstant.DISABLE) {
    //账号被锁定
    throw new AccountLockedException(MessageConstant.ACCOUNT_LOCKED);
}
```
### 6. 核心逻辑说明
1. 前端发送启用或禁用请求，携带状态码 (1 或 0) 和员工 id
2. Controller 接收请求，调用 Service 层方法
3. Service 层创建 Employee 对象，设置状态和 id
4. 调用 Mapper 层执行数据库更新操作
5. Mapper 使用动态 SQL 只更新状态字段，不影响其他字段
6. 登录时会检查员工状态，禁用状态的员工无法登录

整个实现逻辑清晰简洁，通过动态 SQL 确保只更新必要的字段，同时在登录环节增加了状态验证，保证了功能的完整性。